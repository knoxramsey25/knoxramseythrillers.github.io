<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Field Guide — Threat Vectors</title>
  <link rel="stylesheet" href="/assets/css/site.css">
  <link rel="icon" href="/assets/knoxramsey_logo.jpeg" type="image/jpeg">
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="description" content="Supply chain compromises, certificate spoofing, and closed-loop failures that drive the conflict in Dark Recipe."/>
  <style>
    :root{--bg:#071014;--panel:#0c151a;--ink:#e8eef5;--muted:#9fb2c7;--accent:#52ffa8;--danger:#ff4b3e;--line:#17313d}
    *{box-sizing:border-box} html,body{margin:0}
    body{background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;line-height:1.7}
    a{color:var(--accent);text-decoration:none}
    .nav{position:sticky;top:0;z-index:50;background:linear-gradient(180deg,#0e1820,#0a1318);border-bottom:1px solid var(--line)}
    .wrap{max-width:1400px;margin:0 auto;padding:16px 18px}
    .bar{display:flex;gap:14px;align-items:center;justify-content:space-between;flex-wrap:wrap}
    .brand{font-weight:900;letter-spacing:.3px}
    .links{display:flex;gap:14px;flex-wrap:wrap}
    .links a{color:var(--muted);font-weight:700}
    .links a:hover{color:var(--accent)}
    main.wrap{padding:28px 18px}
    .panel{background:var(--panel);border:1px solid var(--line);border-radius:12px;padding:20px;margin-bottom:18px}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:18px}
    .card{background:rgba(82,255,168,0.05);border:1px solid rgba(82,255,168,0.3);border-radius:10px;padding:16px}
    .card h3{margin-top:0}
    .warning{background:rgba(255,75,62,0.1);border:1px solid rgba(255,75,62,0.4);border-radius:10px;padding:16px;color:#ffb3aa}
    ul{margin:0;padding-left:18px}
    
    /* Binder Layout: Sidebar + Content */
    .binder{display:grid;grid-template-columns:280px 1fr;gap:24px;max-width:1400px;margin:0 auto;padding:24px 18px}
    
    /* Sidebar - The "Trapper Keeper" tabs */
    .sidebar{position:sticky;top:80px;height:fit-content;background:var(--panel);border:1px solid var(--line);border-radius:12px;padding:20px;box-shadow:2px 0 12px rgba(0,0,0,0.3)}
    .sidebar h2{margin:0 0 16px 0;font-size:1.1rem;color:var(--accent);border-bottom:2px solid var(--accent);padding-bottom:8px}
    .sidebar nav{display:flex;flex-direction:column;gap:4px}
    .sidebar nav a{display:block;padding:10px 12px;border-radius:6px;color:var(--muted);font-weight:600;border-left:3px solid transparent;transition:all 0.2s}
    .sidebar nav a:hover{background:rgba(82,255,168,0.06);color:var(--accent);border-left-color:var(--accent)}
    .sidebar nav a.active{background:linear-gradient(90deg,rgba(82,255,168,0.08),transparent);color:var(--accent);border-left-color:var(--accent);font-weight:800}
    
    /* Search in sidebar */
    .sidebar .search{margin-bottom:20px}
    .sidebar .search input{width:100%;padding:10px 12px;border-radius:8px;border:1px solid var(--line);background:rgba(255,255,255,0.02);color:var(--ink);font-size:0.95rem}
    .sidebar .search input:focus{outline:2px solid var(--accent);background:rgba(255,255,255,0.04)}
    
    /* Content area */
    .content{min-width:0}
    
    /* Mobile: Stack sidebar on top */
    @media (max-width:900px){
      .binder{grid-template-columns:1fr;gap:16px}
      .sidebar{position:relative;top:0}
    }
    
    /* Mermaid diagram styles */
    .figure{margin:24px 0;background:var(--panel);border:1px solid var(--line);border-radius:12px;padding:20px}
    .figure .mermaid{background:transparent;padding:20px;text-align:center}
    figcaption{text-align:center;color:var(--muted);font-size:0.9rem;margin-top:12px;font-style:italic}
    
    /* Vertical Stepper (mobile-first) */
    .attack-stepper{position:relative;margin:18px 0 28px 0}
    .attack-stepper ol{list-style:none;margin:0;padding:0 0 0 0}
    .attack-stepper li{display:grid;grid-template-columns:28px 1fr;gap:12px;align-items:start;padding:12px 10px;border:1px solid var(--line);border-radius:10px;background:rgba(255,255,255,0.02);margin-bottom:10px}
    .attack-stepper .rail{grid-row:1 / span 2;align-self:stretch;position:relative}
    .attack-stepper .rail::before{content:"";position:absolute;left:13px;top:0;bottom:0;width:2px;background:linear-gradient(var(--line), transparent)}
    .attack-stepper .dot{position:relative;width:18px;height:18px;border-radius:50%;border:2px solid var(--line);background:var(--panel);margin-top:2px;box-shadow:0 0 0 3px rgba(0,0,0,0.15)}
    .attack-stepper .hdr{display:flex;flex-wrap:wrap;gap:10px;align-items:center}
    .attack-stepper .step{display:inline-flex;align-items:center;justify-content:center;width:26px;height:26px;border-radius:6px;border:1px solid var(--line);font-weight:800;font-size:0.85rem;background:rgba(255,255,255,0.03)}
    .attack-stepper .title{font-weight:800;color:#fff}
    .attack-stepper .desc{color:var(--muted);margin-top:6px}
    .attack-stepper a.title{text-decoration:none}
    .attack-stepper a.title:hover{color:var(--accent)}
    .attack-stepper .badge{display:inline-block;padding:2px 8px;border-radius:999px;font-size:0.75rem;font-weight:700;border:1px solid rgba(255,255,255,0.15)}
    
    /* Category colors */
    .recon  .dot{background:#ffd4a3;border-color:#ff9d4d}
    .infil  .dot{background:#ffb3b3;border-color:#ff6666}
    .exec   .dot{background:#d4b3ff;border-color:#9966ff}
    .impact .dot{background:#ff9999;border-color:#ff4444}
    .crisis .dot{background:#ff6666;border-color:#cc0000}
    
    .recon  .badge{color:#1a1a1a;background:#ffd4a3;border-color:#ff9d4d}
    .infil  .badge{color:#1a1a1a;background:#ffb3b3;border-color:#ff6666}
    .exec   .badge{color:#1a1a1a;background:#d4b3ff;border-color:#9966ff}
    .impact .badge{color:#1a1a1a;background:#ff9999;border-color:#ff4444}
    .crisis .badge{color:#fff;background:#ff6666;border-color:#cc0000}
    
    @media (min-width:900px){
      .attack-stepper li{grid-template-columns:32px 1fr;padding:14px 12px}
      .attack-stepper .dot{width:20px;height:20px}
    }

    /* Desktop large diagram container */
    .flowchart-desktop{display:none;margin:24px 0}
    .flowchart-desktop .figure{background:var(--panel);border:1px solid var(--line);border-radius:12px;padding:0;overflow:hidden}
    .flowchart-desktop .figure header{padding:12px 16px;border-bottom:1px solid var(--line);font-weight:700}
    .flowchart-desktop .mermaid{padding:12px}
    .flowchart-desktop .hint{color:var(--muted);font-size:0.85rem;text-align:center;padding:8px 0 12px}
    .btn{display:inline-block;border:1px solid var(--accent);border-radius:8px;padding:10px 14px;margin-top:10px;font-weight:700;text-decoration:none}
    .btn:hover{background:rgba(82,255,168,0.1)}
    @media (min-width:1024px){.flowchart-desktop{display:block}}
  </style>
  <!-- Desktop-only diagram libs (safe to load always) -->
  <script type="module">
    import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";
    mermaid.initialize({
      startOnLoad:true,
      theme:"base",
      securityLevel:"loose",
      flowchart:{useMaxWidth:true,htmlLabels:true,curve:"basis",nodeSpacing:50,rankSpacing:70,padding:8},
      themeVariables:{
        background:"#0d171c",
        lineColor:"#52ffa8",
        textColor:"#e8eef5",
        fontSize:"14px",
        fontFamily:"system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif"
      }
    });
  </script>
  <script src="https://cdn.jsdelivr.net/npm/svg-pan-zoom@3.6.1/dist/svg-pan-zoom.min.js"></script>
  <script>
    function enablePanZoom(scope=document){
      scope.querySelectorAll('.flowchart-desktop .mermaid svg').forEach(svg=>{
        if(svg.dataset.pz) return;
        const pz = svgPanZoom(svg,{zoomEnabled:true,fit:true,center:true,minZoom:0.3,maxZoom:16});
        svg.dataset.pz='1';
        svg.style.cursor='grab';
        svg.addEventListener('mousedown',()=>svg.style.cursor='grabbing');
        svg.addEventListener('mouseup',()=>svg.style.cursor='grab');
      });
    }
    const obs=new MutationObserver(()=>enablePanZoom());
    obs.observe(document.documentElement,{childList:true,subtree:true});
    document.addEventListener('DOMContentLoaded',enablePanZoom);
  </script>
</head>
<body>
  <nav class="nav" aria-label="Primary">
    <div class="wrap bar">
  <div class="brand"><img class="brand-logo" src="/assets/knoxramsey_logo.jpeg" alt="Knox Ramsey Thrillers logo" width="112" height="28" loading="lazy" decoding="async"/>Knox Ramsey Thrillers</div>
      <div class="links">
        <a href="/">Home</a>
        <a href="/fieldguide/">Field Guide</a>
        <a href="/darkrecipe/">Dark Recipe</a>
        <a href="/about.html">About</a>
      </div>
    </div>
  </nav>

  <div class="binder">
    <aside class="sidebar">
      <h2>Field Guide</h2>
      <div class="search">
        <input type="search" placeholder="Search..." aria-label="Search Field Guide">
      </div>
      <nav aria-label="Field Guide sections">
        <a href="/fieldguide/">Overview</a>
        <a href="/fieldguide/timeline.html">Geneva Timeline</a>
        <a href="/fieldguide/biology/">Plant Biology</a>
        <a href="/fieldguide/intelligence/">Intelligence</a>
        <a href="/fieldguide/systems/">Systems</a>
        <a href="/fieldguide/systems/dashboard.html">Dashboard</a>
        <a href="/fieldguide/threats/" class="active">Threats</a>
        <a href="/fieldguide/stuxnet/">Stuxnet Case File</a>
        <a href="/fieldguide/dramatis-personae/">Dramatis Personae</a>
        <a href="/fieldguide/locations/">Key Locations</a>
        <a href="/fieldguide/us-structure/">US Inter-Agency</a>
        <a href="/fieldguide/glossary/">Glossary</a>
      </nav>
    </aside>

    <main class="content">

    <h1>Threat Vectors</h1>
    <div class="panel">
      <p class="muted">Attackers exploit both the software supply chain and edge trust boundaries. The notes below mirror the investigative threads followed by Knox Ramsey.</p>
    </div>

    <h2>Attack Chain: Supply Chain to Public Exposure</h2>
    <section class="attack-stepper" aria-label="Attack Chain steps">
      <ol>
        <li class="recon">
          <div class="rail"><span class="dot" aria-hidden="true"></span></div>
          <div>
            <div class="hdr">
              <span class="step">1</span>
              <a class="title" href="/fieldguide/intelligence/">Initial Recon — Compromise 1 Vendor</a>
              <span class="badge">Recon</span>
            </div>
            <div class="desc">Target profiling, supplier mapping, and foothold via a single vendor relationship.</div>
          </div>
        </li>
        <li class="recon">
          <div class="rail"><span class="dot" aria-hidden="true"></span></div>
          <div>
            <div class="hdr">
              <span class="step">2</span>
              <a class="title" href="/fieldguide/intelligence/">Credential Harvest — API / Cert Leakage</a>
              <span class="badge">Recon</span>
            </div>
            <div class="desc">Keys and certificates exposed through supplier systems and CI artifacts.</div>
          </div>
        </li>
        <li class="infil">
          <div class="rail"><span class="dot" aria-hidden="true"></span></div>
          <div>
            <div class="hdr">
              <span class="step">3</span>
              <a class="title" href="/fieldguide/systems/">FarmLytics Infiltration — Weight Tampering</a>
              <span class="badge">Infiltration</span>
            </div>
            <div class="desc">Poisoned model weights and policy packages enter the update channel.</div>
          </div>
        </li>
        <li class="infil">
          <div class="rail"><span class="dot" aria-hidden="true"></span></div>
          <div>
            <div class="hdr">
              <span class="step">4</span>
              <a class="title" href="/fieldguide/systems/">Recipe Manipulation — Light/Nitrogen/Temp</a>
              <span class="badge">Infiltration</span>
            </div>
            <div class="desc">Blue light spikes, nitrogen stress, and thermal oscillation encoded as "optimization".</div>
          </div>
        </li>
        <li class="exec">
          <div class="rail"><span class="dot" aria-hidden="true"></span></div>
          <div>
            <div class="hdr">
              <span class="step">5</span>
              <a class="title" href="/fieldguide/systems/dashboard.html">FarmCore Executes — Telemetry Trusted</a>
              <span class="badge">Execution</span>
            </div>
            <div class="desc">Edge controller accepts spoofed signals; Safety Kernel v1 fails to block.</div>
          </div>
        </li>
        <li class="exec">
          <div class="rail"><span class="dot" aria-hidden="true"></span></div>
          <div>
            <div class="hdr">
              <span class="step">6</span>
              <a class="title" href="/fieldguide/biology/">Plant Stress — Phenolic Aldehydes</a>
              <span class="badge">Execution</span>
            </div>
            <div class="desc">Biochemical defense cascades elevate toxins; crop quality silently degrades.</div>
          </div>
        </li>
        <li class="impact">
          <div class="rail"><span class="dot" aria-hidden="true"></span></div>
          <div>
            <div class="hdr">
              <span class="step">7</span>
              <a class="title" href="/fieldguide/locations/">Distribution Chain — Contaminated Flow</a>
              <span class="badge">Impact</span>
            </div>
            <div class="desc">Outbound logistics propagate contaminated batches beyond the facility boundary.</div>
          </div>
        </li>
        <li class="crisis">
          <div class="rail"><span class="dot" aria-hidden="true"></span></div>
          <div>
            <div class="hdr">
              <span class="step">8</span>
              <span class="title">Public Exposure — Poisonings, ER Overload</span>
              <span class="badge">Crisis</span>
            </div>
            <div class="desc">Health systems register spikes; investigations correlate distributed supply lots.</div>
          </div>
        </li>
      </ol>
    </section>

    <!-- Desktop-only large flow diagram -->
    <section class="flowchart-desktop" aria-label="Large attack flow diagram">
      <h2 style="margin-top:0">Attack Flow (Large Diagram)</h2>
      <div class="figure">
        <header>Supply Chain → Infiltration → Execution → Impact → Crisis</header>
        <div class="mermaid">
flowchart LR
  subgraph P1[Recon]
    A["Initial Recon<br/>Compromise 1 Vendor"] --> B["Credential Harvest<br/>API / Cert Leakage"]
  end
  subgraph P2[Infiltration]
    C["FarmLytics Infiltration<br/>Model Weight Tampering"] --> D["Recipe Manipulation<br/>Light Spikes · N Stress · Temp Oscillation"]
  end
  subgraph P3[Execution]
    E["FarmCore Executes<br/>Telemetry Trusted"] --> F["Plant Stress<br/>Phenolic Aldehydes ↑"]
  end
  subgraph P4[Impact]
    G["Distribution Chain<br/>Contaminated Flow"]
  end
  subgraph P5[Crisis]
    H["Public Exposure<br/>Poisonings · ER Overload"]
  end
  B --> C
  D --> E
  F --> G
  G --> H
  classDef recon fill:#ffd4a3,stroke:#ff9d4d,stroke-width:2px,color:#1a1a1a
  classDef infiltrate fill:#ffb3b3,stroke:#ff6666,stroke-width:2px,color:#1a1a1a
  classDef execute fill:#d4b3ff,stroke:#9966ff,stroke-width:2px,color:#1a1a1a
  classDef impact fill:#ff9999,stroke:#ff4444,stroke-width:2px,color:#1a1a1a
  classDef crisis fill:#ff6666,stroke:#cc0000,stroke-width:3px,color:#fff
  class A,B,P1 recon
  class C,D,P2 infiltrate
  class E,F,P3 execute
  class G,P4 impact
  class H,P5 crisis
        </div>
        <div class="hint">Tip: Scroll to zoom · Drag to pan</div>
      </div>
      <a class="btn" href="/fieldguide/threats/attack-flow.html">Open full-screen chart →</a>
    </section>

    <div class="grid">
      <div class="card">
        <h3>Supply Chain Compromise</h3>
        <p>Malicious model weights inserted before deployment. Configuration packages transit legitimate logistics, masking tampering.</p>
        <ul>
          <li>Poisoned training data targeting spectral optimization</li>
          <li>Signed firmware updated via trusted vendor portal</li>
          <li>Orchestrated to appear as a calibration patch</li>
        </ul>
      </div>
      <div class="card">
        <h3>Credential &amp; Certificate Spoofing</h3>
        <p>Attackers forge trust anchors to bypass advisory-only safeguards.</p>
        <ul>
          <li>Compromised certificate authority issues fraudulent edge certs</li>
          <li>Shadow PKI mimics FarmLytics policy updates</li>
          <li>Gateway accepts poisoned recipes as authentic</li>
        </ul>
      </div>
      <div class="card">
        <h3>Closed-Loop Blind Spots</h3>
        <p>Safety Kernel v1 runs single-channel verification, allowing doctored telemetry to pass.</p>
        <ul>
          <li>Shadow test relies on spoofed sensor replay</li>
          <li>Logging occurs, but alerts are suppressed downstream</li>
          <li>Upgraded Kernel v2 introduces dual-channel physics checks</li>
        </ul>
      </div>
    </div>

    <section class="warning" style="margin-top:18px">
      <h2 style="margin-top:0;color:#ffb3aa">Incident Lessons</h2>
      <p>Stuxnet, the Ukraine power grid attacks, TRITON/TRISIS, Colonial Pipeline, and the JBS intrusion demonstrate that cyber-physical exploits escalate quickly. The Dark Recipe plot aligns with documented tactics but compresses the timeline for dramatic effect.</p>
    </section>
  
    </main>
  </div>
  <script src="/assets/js/fieldguide.js"></script>
</body>
</html>
